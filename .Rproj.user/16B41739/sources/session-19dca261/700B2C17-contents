---
title: "Capstone"
author: "Quan Ke Truong"
date: "2025-06-11"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading neccessary package and data

```{r, echo = FALSE}

library(tidyverse)
library(skimr)
library(lubridate)
library(janitor)

df <- read.csv("../day1/data/life-exp.csv")
```

## Khám phá dữ liệu

```{r, echo=FALSE}
view(df)

#chuyển dữ liệu thành tibble
df <- as_tibble(df) %>% clean_names()


#kiểm tra các loại dữ liệu
str(df)

#kiểm tra xem các biến có bị mất dữ liệu không
skimr::skim(df)

#Thay đổi tên cột cho đúng quy tắc
df <- df  %>% rename(life_expectancy = Life.expectancy,
              adult_mortality = Adult.Mortality,
              infant_deaths = infant.deaths,
              percentage_expenditure = percentage.expenditure,
              Hepatitis_B = Hepatitis.B,
              under_five_deaths = under.five.deaths,
              total_expenditure = Total.expenditure,
              HIV_AIDS = HIV.AIDS,
              thinness_1_19_years = thinness..1.19.years,
              thinness_5_9_years = thinness.5.9.years,
              income_composition_of_resources =     Income.composition.of.resources) 

#Chuyển các biến về loại dữ liệu hợp lý
df <- df %>% mutate(status = as.factor(status),
                    country = as.factor(country))

```

##Xử lý và phân tích dữ liệu
```{r, echo=FALSE}

df_diseases <- df %>% select(Measles, Polio, Diphtheria)
head(df_diseases)

#Truy xuất hàng 2 cột 5
df[2,5]

#Thay thế giá trị missing của cột life expectancy (cột life expectancy không có mất dữ liệu)
sum(is.na(df$life_expectancy))

#Truy xuất hàng 2,5 và cột Measles, Polio 
df[c(2,5), c("Measles","Polio")]

#Tìm ra 5 quốc gia có tuổi thọ trung bình cao nhất năm 2015 và gán thành top_5
top_5 <- df %>% filter(year == 2015) %>% group_by(country) %>% summarise(mean_age = sum(life_expectancy)) %>% slice_max(mean_age, n=5) %>% select(country)

#Tìm ra 5 quốc gia có tuổi thọ trung bình thấp nhất năm 2015 và gán thành top_5
bot_5 <- df %>% filter(year == 2015) %>% group_by(country) %>% summarise(mean_age = sum(life_expectancy)) %>% slice_min(mean_age, n=5) %>% select(country)

#Tạo 1 data frame chứa 2 đối tượng top_5 và bot_5 và gán thành df_top_bot
df_top_bot <- rbind(top_5, bot_5)


#Tạo biến mới bmi_lv là biến thứ tự gồm các nhóm: dưới 18.5, từ 18.5 đến 23, trên 23.
df <- df %>% mutate(bmi_lv = case_when(bmi < 18.5 ~ "dưới 18.5",
                                 bmi >= 18.5 & bmi <= 23 ~ "từ 18.5 đến 23",
                                 bmi > 23 ~ "trên 23"))

#Sử dụng df nhóm theo country để tính trung bình GDP và gán thành df_gdp_by_country.

df_gdp_by_country <- df %>% group_by(country) %>% summarise(mean_gdp = mean(gdp))
  
```



```{r, echo=FALSE}



```





