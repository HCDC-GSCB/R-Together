pct_cases = ifelse(
total_cases_per_date == 0,
NA,
total_cases * 100 / total_cases_per_date
),
week = week (date)) %>%
na.omit()
plot_data %>%
mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.5) +
scale_x_date(date_labels = "W%U",
date_breaks = "1 week",
expand = c(0, 0)) +
scale_y_continuous(
labels = function(x)
paste(x, "%"),
breaks = seq(0, 100, 10),
expand = c(0, 0)
) +
scale_fill_discrete(
name = "Country",
breaks = c("chn", "deu", "esp", "ita", "usa", "Others"),
labels = c("China", "Germany", "Spain", "Italy", "USA", "Others")
) +
labs(title = "Percentage of COVID case counts per country for the first 10 weeks of 2020", x = "Date", y = "Percent of total cases") +
theme_classic(base_size = 14) +
theme(legend.position = "bottom",
axis.text = element_text(size = 12, color = "black"))
covid_cases <- readRDS("day2/data/covid_cases.rds")
library(tidyverse)
## Task 2
covid_cases %>% pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
as_tibble() %>%
skimr::skim()
incorrect_data <- covid_cases %>%
pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
filter(cases < 0)
correct_data <- covid_cases %>%
pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
anti_join(incorrect_data, by = c("date", "country", "cases"))
covid_cases <- correct_data %>%
mutate(country = str_remove(country, "cases_")) %>%
filter(week(date) >= 3 & week(date) <= 12)
## Task 3
top_countries <- covid_cases %>%
group_by(country) %>%
summarise(total_cases = sum(cases)) %>%
slice_max(total_cases, n = 5) %>%
pull(country)
plot_data <- covid_cases %>%
mutate(country = as.factor(ifelse(
country %in% top_countries, country, "Others"
))) %>%
group_by(date, country) %>%
summarise(total_cases = sum(cases)) %>%
mutate(
total_cases_per_date = sum(total_cases),
pct_cases = ifelse(
total_cases_per_date == 0,
NA,
total_cases * 100 / total_cases_per_date
),
week = week(date)
) %>%
na.omit()
plot_data %>%
mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
## Task 4
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.5) +
scale_x_date(date_labels = "W%U",
date_breaks = "1 week",
expand = c(0, 0)) +
scale_y_continuous(
labels = function(x)
paste(x, "%"),
breaks = seq(0, 100, 10),
expand = c(0, 0)
) +
scale_fill_discrete(
name = "Country",
breaks = c("chn", "deu", "esp", "ita", "usa", "Others"),
labels = c("China", "Germany", "Spain", "Italy", "USA", "Others")
) +
labs(title = "Percentage of COVID case counts per country for the first 10 weeks of 2020", x = "Date", y = "Percent of total cases") +
theme_classic(base_size = 14) +
theme(legend.position = "bottom",
axis.text = element_text(size = 12, color = "black"))
#Nhiệm vụ 1: Import dữ liệu
covid_cases <- readRDS("day2/data/covid_cases.rds")
#Chuyển dữ liệu thành tibble
covid_cases <- tibble(covid_cases)
covid_cases <- covid_cases %>% pivot_longer(
cols = -date,
names_to = "country",
names_prefix = "cases_",
values_to = "cases"
)
View(covid_cases)
covid_cases <- covid_cases %>% pivot_longer(
cols = -date,
values_to = "cases"
) %>% as.tibble() %>% skimr::skim()
#Nhiệm vụ 1: Import dữ liệu
covid_cases <- readRDS("day2/data/covid_cases.rds")
covid_cases <- covid_cases %>% pivot_longer(
cols = -date,
values_to = "cases"
) %>% as.tibble() %>% skimr::skim()
View(covid_cases)
#Nhiệm vụ 1: Import dữ liệu
covid_cases <- readRDS("day2/data/covid_cases.rds")
covid_cases %>% pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
as_tibble() %>% skimr::skim()
View(covid_cases)
incorrect_data <- covid_cases %>%
pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
filter(cases < 0)
View(incorrect_data)
correct_data <- covid_cases %>%
pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
anti_join(incorrect_data, by = c("date", "country", "cases"))
View(incorrect_data)
View(covid_cases)
View(covid_cases)
View(correct_data)
covid_cases <- correct_data %>%
mutate(country = str_remove(country, "cases_")) %>%
filter(week(date) >= 3 & week(date) <= 12)
View(covid_cases)
top_countries <- covid_cases %>% group_by(country)%>% summarise(total_cases = sum(cases, na.rm = TRUE)) %>%
ungroup() %>% slice_max(total_cases, n = 5) %>%
pull(country)
plot_data <- covid_cases %>% mutate(country = as.factor(ifelse(
country %in% top_countries, top_countries, "Others"
))) %>%
group_by(date,country) %>%
summarise(total_cases = sum(cases)) %>%
mutate(total_cases_per_date = sum(total_cases),
pct_cases = ifelse(
total_cases_per_date == 0,
NA,
total_cases * 100 / total_cases_per_date
),
week = week (date)) %>%
na.omit()
View(plot_data)
plot_data %>%
mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.5) +
scale_x_date(date_labels = "W%U",
date_breaks = "1 week",
expand = c(0, 0)) +
scale_y_continuous(
labels = function(x)
paste(x, "%"),
breaks = seq(0, 100, 10),
expand = c(0, 0)
) +
scale_fill_discrete(
name = "Country",
breaks = c("chn", "deu", "esp", "ita", "usa", "Others"),
labels = c("China", "Germany", "Spain", "Italy", "USA", "Others")
) +
labs(title = "Percentage of COVID case counts per country for the first 10 weeks of 2020", x = "Date", y = "Percent of total cases") +
theme_classic(base_size = 14) +
theme(legend.position = "bottom",
axis.text = element_text(size = 12, color = "black"))
#Nhiệm vụ 1: Import dữ liệu
covid_cases <- readRDS("day2/data/covid_cases.rds")
#Nhiệm vụ 1: Import dữ liệu
covid_cases <- readRDS("day2/data/covid_cases.rds")
covid_cases %>% pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
as_tibble() %>% skimr::skim()
incorrect_data <- covid_cases %>%
pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
filter(cases < 0)
correct_data <- covid_cases %>%
pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
anti_join(incorrect_data, by = c("date", "country", "cases"))
covid_cases <- correct_data %>%
mutate(country = str_remove(country, "cases_")) %>%
filter(week(date) >= 3 & week(date) <= 12)
top_countries <- covid_cases %>%
group_by(country) %>%
summarise(total_cases = sum(cases)) %>%
slice_max(total_cases, n = 5) %>%
pull(country)
plot_data <- covid_cases %>%
mutate(country = as.factor(ifelse(
country %in% top_countries, country, "Others"
))) %>%
group_by(date, country) %>%
summarise(total_cases = sum(cases)) %>%
mutate(
total_cases_per_date = sum(total_cases),
pct_cases = ifelse(
total_cases_per_date == 0,
NA,
total_cases * 100 / total_cases_per_date
),
week = week(date)
) %>%
na.omit()
plot_data %>%
mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.5) +
scale_x_date(date_labels = "W%U",
date_breaks = "1 week",
expand = c(0, 0)) +
scale_y_continuous(
labels = function(x)
paste(x, "%"),
breaks = seq(0, 100, 10),
expand = c(0, 0)
) +
scale_fill_discrete(
name = "Country",
breaks = c("chn", "deu", "esp", "ita", "usa", "Others"),
labels = c("China", "Germany", "Spain", "Italy", "USA", "Others")
) +
labs(title = "Percentage of COVID case counts per country for the first 10 weeks of 2020", x = "Date", y = "Percent of total cases") +
theme_classic(base_size = 14) +
theme(legend.position = "bottom",
axis.text = element_text(size = 12, color = "black"))
View(plot_data)
View(covid_cases)
View(plot_data)
plot_data %>%
mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.5) #+
plot_data %>%
mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) #+
plot_data %>%
mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.5) +
scale_x_date(date_labels = "W%U",
date_breaks = "1 week",
expand = c(0, 0)) +
scale_y_continuous(
labels = function(x)
paste(x, "%"),
breaks = seq(0, 100, 10),
expand = c(0, 0)
) +
scale_fill_discrete(
name = "Country",
breaks = c("chn", "deu", "esp", "ita", "usa", "Others"),
labels = c("China", "Germany", "Spain", "Italy", "USA", "Others")
) +
labs(title = "Percentage of COVID case counts per country for the first 10 weeks of 2020", x = "Date", y = "Percent of total cases") +
theme_classic(base_size = 14) +
theme(legend.position = "bottom",
axis.text = element_text(size = 12, color = "black"))
plot_data %>%
mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.5) +
scale_x_date(date_labels = "W%U",
date_breaks = "1 week",
expand = c(0, 0)) +
scale_y_continuous(
labels = function(x)
paste(x, "%"),
breaks = seq(0, 100, 10),
expand = c(0, 0)
)
plot_data %>%
mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.5)
View(incorrect_data)
#Nhiệm vụ 1: Import dữ liệu
covid_cases <- readRDS("day2/data/covid_cases.rds")
covid_cases %>% pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
as_tibble() %>% skimr::skim()
View(covid_cases)
incorrect_data <- covid_cases %>%
pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
filter(cases < 0)
View(incorrect_data)
correct_data <- covid_cases %>%
pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
anti_join(incorrect_data, by = c("date", "country", "cases"))
covid_cases <- correct_data %>%
mutate(country = str_remove(country, "cases_")) %>%
filter(week(date) >= 3 & week(date) <= 12)
covid_cases <- pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>% as.tibble() %>% skimr::skim
covid_cases <- readRDS("day2/data/covid_cases.rds")
covid_cases <- pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>% as.tibble() %>% skimr::skim()
View(covid_cases)
library(tidyverse)
library(ggplot2)
library(skimr)
library(dplyr)
library(lubridate)
covid_cases <- readRDS("day2/data/covid_cases.rds")
covid_cases <- pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>% as.tibble() %>% skimr::skim()
covid_cases <- covid_cases %>%  pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>% as.tibble() %>% skimr::skim()
View(covid_cases)
covid_cases %>%  pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>% as.tibble() %>% skimr::skim()
covid_cases <- readRDS("day2/data/covid_cases.rds")
covid_cases %>%  pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>% as.tibble() %>% skimr::skim()
incorrect_data <- covid_cases %>% pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
filter(cases < 0)
View(incorrect_data)
correct_data <- covid_cases %>% pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
anti_join(incorrect_data, by = c("date","country","cases"))
View(covid_cases)
View(correct_data)
covid_cases <- correct_data %>% str_remove(country,"cases_") %>%
filter(week(date)>=3&week(date)=<12)
covid_cases <- correct_data %>% str_remove(country,"cases_") %>%
filter(week(date)>=3&week(date)<=12)
covid_cases <- correct_data %>% mutate(country = str(country,"cases_")) %>%
filter(week(date)>=3&week(date)<=12)
View(covid_cases)
covid_cases <- readRDS("day2/data/covid_cases.rds")
covid_cases %>%  pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>% as.tibble() %>% skimr::skim()
incorrect_data <- covid_cases %>% pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
filter(cases < 0)
correct_data <- covid_cases %>% pivot_longer(cols = -date,
names_to = "country",
values_to = "cases") %>%
anti_join(incorrect_data, by = c("date","country","cases"))
covid_cases <- correct_data %>% mutate(country = str_remove(country,"cases_")) %>%
filter(week(date)>=3&week(date)<=12)
View(correct_data)
top_countries <- covid_cases %>% group_by(country) %>% summarise(total_cases_per_country = sum(cases)) %>%
slice_max(total_cases_per_country, n=5)
View(top_countries)
top_countries <- covid_cases %>% group_by(country) %>% summarise(total_cases_per_country = sum(cases)) %>%
slice_max(total_cases_per_country, n=5) %>% pull(country)
plot_data <- covid_cases %>% mutate(country = as.factor(ifelse(country %in% top_countries,top_countries,"Others"))) %>%
group_by(date,country) %>%
summarise(total_cases = sum(cases)) %>%
mutate(total_cases_per_date = sum(total_cases),
pct_cases = (total_cases*100/total_cases_per_date), week = week(date)) %>%
na.omit()
View(plot_data)
plot_data <- covid_cases %>% mutate(country = as.factor(ifelse(country %in% top_countries,top_countries,"Others"))) %>%
group_by(date,country) %>%
summarise(total_cases_per_country = sum(cases)) %>%
mutate(total_cases_per_date = sum(total_cases_per_country),
pct_cases = (total_cases_per_country*100/total_cases_per_date), week = week(date)) %>%
na.omit()
View(plot_data)
plot_data %>% mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area()
plot_data <- covid_cases %>%
mutate(country = as.factor(ifelse(
country %in% top_countries, country, "Others"
))) %>%
group_by(date, country) %>%
summarise(total_cases = sum(cases)) %>%
mutate(
total_cases_per_date = sum(total_cases),
pct_cases = ifelse(
total_cases_per_date == 0,
NA,
total_cases * 100 / total_cases_per_date
),
week = week(date)
) %>%
na.omit()
plot_data %>% mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area()
plot_data %>% mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.2)
plot_data %>% mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.3)
plot_data %>% mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.3) +
scale_x_date(date_labels = "W%U",
breaks = "1 week",
expand = c(0, 0))
plot_data %>% mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.3) +
scale_x_date(date_labels = "W%U",
breaks = "1 week",
expand = c(0, 0)) +
scale_y_continuous(labels = function(x)
paste(x, "%"),
breaks = seq(0, 100, 10),
expand = c(0, 0))
plot_data %>% mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.3) +
scale_x_date(date_labels = "W%U",
breaks = "1 week",
expand = c(0, 0)) +
scale_y_continuous(labels = function(x)
paste(x, "%"),
breaks = seq(0, 100, 10),
expand = c(0, 0)) +
scale_fill_discrete(
name = "country",
breaks = c("chn", "deu", "esp", "ita", "usa", "Others"),
labels = c("China", "Germany", "Spain", "Italy", "USA", "Others")
)
plot_data %>% mutate(country = fct_relevel(country, "chn", "deu", "esp",
"ita", "usa", "Others")) %>%
ggplot(aes(x = date, y = pct_cases, fill = country)) +
geom_area(color = "black", size = 0.3) +
scale_x_date(date_labels = "W%U",
breaks = "1 week",
expand = c(0, 0)) +
scale_y_continuous(labels = function(x)
paste(x, "%"),
breaks = seq(0, 100, 10),
expand = c(0, 0)) +
scale_fill_discrete(
name = "country",
breaks = c("chn", "deu", "esp", "ita", "usa", "Others"),
labels = c("China", "Germany", "Spain", "Italy", "USA", "Others")
) +
labs(title = "Percentage of COVID case counts per country for the first 10 weeks of 2020", x = "Date", y = "Percent of total cases") +
theme_classic(base_size = 14) +
theme(legend.position = "bottom",
axis.text = element_text(size = 12, color = "black"))
knitr::opts_chunk$set(echo = TRUE)
df <- read.csv("../day1/data/covid_cases.life-exp.csv")
df <- read.csv("R-Together/day1/data/covid_cases.life-exp.csv")
df <- read.csv("R-Together/day1/data/life-exp.csv")
df <- read.csv("../day1/data/life-exp.csv")
library(tidyverse)
library(skimr)
library(lubridate)
library(janitor)
echo = FALSE
library(tidyverse)
library(skimr)
library(lubridate)
library(janitor)
df <- read.csv("../day1/data/life-exp.csv")
library(tidyverse)
library(skimr)
library(lubridate)
library(janitor)
df <- read.csv("../day1/data/life-exp.csv")
